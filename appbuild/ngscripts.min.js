var app=angular.module("RestaurantApp",["ngGeolocation","ngAnimate"]);app.controller("MainController",["$scope","foursquareService","locationService","$geolocation",function(e,t,a,o){e.venueTypes=[{type:"bar",categoryId:"4bf58dd8d48988d116941735"},{type:"restaurant",categoryId:"4d4b7105d754a06374d81259"},{type:"coffee",categoryId:"4bf58dd8d48988d1e0931735"}],e.priceRanges=[{symbol:"$",priceValue:"1"},{symbol:"$$",priceValue:"2"},{symbol:"$$$",priceValue:"3"},{symbol:"$$$$",priceValue:"4"}],e.selectedLocation="",e.selectedType="",e.selectedPrice="",e.selectedQuery="restaurant",e.placesCount,e.lat="",e.lng="",e.getData=function(){""===e.selectedLocation?e.getLocationData():e.getFoursquareData()},e.getLocationData=function(){a.getData().then(function(t){e.lat=t.data.location.lat,e.lng=t.data.location.lng,e.getFoursquareData()},function(e){})},e.getFoursquareData=function(){t.getData(e.selectedLocation,e.lat,e.lng,e.selectedType,e.selectedPrice,e.selectedQuery).then(function(t){t.data.response.groups?(e.places=t.data.response.groups[0].items,e.placesCount=e.places.length):e.placesCount=0},function(e){})},e.buildVenueThumbnail=function(e){return e.items[0].prefix+"200x200"+e.items[0].suffix},e.isEmptyObject=function(e){return null==e||"undefined"==e},e.getLocationData()}]),app.factory("locationService",["$http","$q",function(e){var t={getData:function(){var t=e({url:"https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyAgCpmzDnH5XX1fVpTi7VI9SrHrEBYPzkE",method:"post"});return t}};return t}]),app.factory("foursquareService",["$http","$q",function(e){var t="XP4VP0ASW5BTRAVCYEEMCQQFVIQGO1FPAI5ZR2GVEVXHVKOL",a="C4SH5M4HHKWABXYTSBXZZXKDA4S120G1ZWTCED5WECPEWQXP",o={getData:function(o,n,r,c,l,u){var i={query:u,limit:7,client_id:t,client_secret:a,price:l.priceValue,venuePhotos:1,v:20140806,callback:"JSON_CALLBACK"};""===o?i.ll=n+","+r:i.near=o;var s=e({url:"https://api.foursquare.com/v2/venues/explore",method:"jsonp",params:i});return s}};return o}]);